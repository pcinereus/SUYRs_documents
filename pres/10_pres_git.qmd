---
title: "Git and Github"
author: "Murray Logan"
date: today
date-format: "D MMMM YYYY"
format:
  revealjs:
    embed-resources: true
    auto-stretch: false
    css: ../resources/pres-style.css
    margin: 0
output_dir: "docs"
bibliography: ../resources/references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tinytex.engine = "xelatex")

```
            

# Background
            
Required
--------------

>- [git](https://git-scm.com/downloads)

>- [github account](http://www.github.com)

>- RStudio or text editor

Version control
-----------------
  
```{tikz}
%| label: fig1
%| engine: tikz
%| echo: false
%| fig-width: 13
%| fig-height: 6
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-minimal.tex"
\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}] 
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]
\tikzstyle{fileText} = [font={\fontspec[Scale=1]{Inconsolata Nerd Font}}] 
\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}
\definecolor{color_index}{rgb}{0.78,0.86,0.27}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}
\definecolor{color_main}{rgb}{0.36,0.27,0.87}
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}
\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}

\file{0,0}{\begin{minipage}{1.3cm}\textcolor{red}{- item 1}\\\textcolor{red}{- item 2}\end{minipage}}{F1}
\node [fileText] at ($(F1) + (0.75,0.3)$) {Version 1};
\node [fileText] at ($(F1) + (0.75,-2.3)$) {todo.txt};

\file{2,0}{\begin{minipage}{1.3cm}- item 1\\- item 2\\\textcolor{red}{- item 3}\end{minipage}}{F2}
\node [fileText] at ($(F2) + (0.75,0.3)$) {Version 2};
\node [fileText] at ($(F2) + (0.75,-2.3)$) {todo2.txt};

\file{4,0}{\begin{minipage}{1.3cm}- item 1\\- item 2\\- item 3\\\textcolor{red}{- item 4}\end{minipage}}{F3}
\node [fileText] at ($(F3) + (0.75,0.3)$) {Version 3};
\node [fileText] at ($(F3) + (0.75,-2.3)$) {todo3.txt};

\file{6,0}{\begin{minipage}{1.3cm}- item 1\\- item 2\\\textcolor{blue}{- item 4}\end{minipage}}{F4}
\node [fileText] at ($(F4) + (0.75,0.3)$) {Version 4};
\node [fileText] at ($(F4) + (0.75,-2.3)$) {todo4.txt};

\node [fileText] at ($(F4) +(3.5,-1)$) {\begin{minipage}{2.5cm}An example of a poor, adhoc versioning system.\end{minipage}};)

\end{tikzpicture}
```


## Version control 

>- large space requirements
>- difficult to collaborate

. . .

```{tikz}
%| label: fig3
%| engine: tikz
%| echo: false
%| fig-width: 8
%| fig-height: 6
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"
\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}] 
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]
\tikzstyle{fileText} = [font={\fontspec[Scale=1]{Inconsolata Nerd Font}}] 
\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}
\definecolor{color_index}{rgb}{0.78,0.86,0.27}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}
\definecolor{color_main}{rgb}{0.36,0.27,0.87}
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}
\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}
\begin{tikzpicture}

%Version 1
\file{0,0}{\begin{minipage}{1.3cm}\textcolor{red}{- item 1}\\\textcolor{red}{- item 2}\end{minipage}}{F1}
\node [fileText] at ($(F1) + (0.75,-2.3)$) {todo.txt};

\file{0,-3}{\begin{minipage}{1.3cm}\textcolor{red}{Title}\\[1em]\textcolor{red}{content}\end{minipage}}{F1a}
\node [fileText] at ($(F1a) + (0.75,-2.3)$) {fileA.doc};


\node [fileText] at ($(F1) + (0.2,0.5)$) (V1) {Version 1};
\draw (V1.200) -- (V1.200 |- F1a);
\draw (V1.200 |- F1) -- (F1);
\draw (V1.200 |- F1a) -- (F1a);

%Version 2
\file{3,0}{\begin{minipage}{1.3cm}- item 1\\- item 2\\\textcolor{red}{- item 3}\end{minipage}}{F2}
\node [fileText] at ($(F2) + (0.75,-2.3)$) {todo.txt};

\file{3,-3}{\begin{minipage}{1.3cm}\textcolor{black}{Title}\\[1em]\textcolor{black}{content}\end{minipage}}{F2a}
\node [fileText] at ($(F2a) + (0.75,-2.3)$) {fileA.doc};

\file{3,-6}{\begin{minipage}{1.3cm}\textcolor{red}{ID,Num}\\\textcolor{red}{1,10}\\\textcolor{red}{2,15}\end{minipage}}{F2b}
\node [fileText] at ($(F2b) + (0.75,-2.3)$) {fileB.csv};

\node [fileText] at ($(F2) + (0.2,0.5)$) (V2) {Version 2};
\draw (V2.200) -- (V2.200 |- F2b);
\draw (V2.200 |- F2) -- (F2);
\draw (V2.200 |- F2a) -- (F2a);
\draw (V2.200 |- F2b) -- (F2b);

%Version 3
\file{6,0}{\begin{minipage}{1.3cm}- item 1\\- item 2\\- item 3\\\textcolor{red}{- item 4}\end{minipage}}{F3}
\node [fileText] at ($(F3) + (0.75,-2.3)$) {todo.txt};

%\file{6,-3}{\begin{minipage}{1.3cm}\textcolor{black}{Title}\\[1em]\textcolor{black}{content}\end{minipage}}{F3a}
\node [anchor=west,text=green!50!black!50] at (6,-3) (F3a) {\#\#\#\#\#\#}; 
\node [fileText] at ($(F3 |- F3a) + (0.75,-0.5)$) {fileA.doc};
\draw[->,very thick,color=green!50!black!50] (F3a) -- ($(F2a) +(1.6,-0.5)$);


\file{6,-6}{\begin{minipage}{1.3cm}\textcolor{black}{ID,Num}\\\textcolor{black}{1,10}\\2,\textcolor{blue}{25}\end{minipage}}{F3b}
\node [fileText] at ($(F3b) + (0.75,-2.3)$) {fileB.csv};

\node [fileText] at ($(F3) + (0.2,0.5)$) (V3) {Version 3};
\draw (V3.200) -- (V3.200 |- F3b);
\draw (V3.200 |- F3) -- (F3);
\draw (V3.200 |- F3a) -- (F3a);
\draw (V3.200 |- F3b) -- (F3b);

\node [fileText] at ($(F3) +(4,-1)$) {\begin{minipage}{3cm}An example of a more sophisticated, yet efficient versioning system\end{minipage}};

\end{tikzpicture}

```
 . . .


## Git


## Git - overview 

>- Git - is a **distributed version control system**

>- Git - stores **snapshots** of the filesystem
	- **commits**

. . .

```{tikz}
%| label: Commits
%| engine: tikz
%| echo: false
%| fig-width: 1.5
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns}

\usetikzlibrary{arrows.meta}

\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}]
\tikzstyle{hashText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 
\tikzstyle{commentText} = [font={\fontspec[Scale=1.0]{Inconsolata Nerd Font}}] 
\tikzstyle{refText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 

\definecolor{color_branch}{rgb}{1,0.8,0.4}
\definecolor{color_head}{HTML}{6495ED} %
\definecolor{color_HEAD}{rgb}{0.26,0.65,0.91}
\definecolor{color_commit}{rgb}{0.9,0.9,0.2}
\definecolor{color_inactive}{rgb}{0.90,0.9,0.9}
\definecolor{color_detached}{rgb}{0.90,0.9,0.9}
\definecolor{color_derivative}{rgb}{0.12,0.6,0.51}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}


% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

\newcommand{\commit}[5]{
\node [#1,inner sep=0,outer sep=0] (#2) {
\begin{tikzpicture}[#1]
\draw [#1] node [draw=black!40!#3,fill=#3,shape=circle,minimum width=1.0cm,line width=3pt] (x) {};
%\node [below,hashText] at (x.south) {#4};
\end{tikzpicture}
};
\node [below,hashText] at (#2.south) {#4};
\node [below,commentText,text=gray] at ($(#2.south) +(0,-0.5)$) {#5};
}

\newcommand{\rcommit}[5]{
\node [#1,inner sep=0,outer sep=0] (#2) {
\begin{tikzpicture}[#1]
\draw [#1] node [draw=black!40!#3,fill=#3,shape=rectangle,minimum width=1.0cm,minimum height=1.0cm,line width=3pt] (x) {};
%\node [below,hashText] at (x.south) {#4};
\end{tikzpicture}
};
\node [below,hashText] at (#2.south) {#4};
\node [below,commentText,text=gray] at ($(#2.south) +(0,-0.5)$) {#5};
}

\newcommand{\main}[1] {
\node [#1,rectangle,fill=color_branch,draw=black!20!color_branch,line width=2pt,refText,minimum height=0.8cm] (main) {main};
}
\newcommand{\rmain}[1] {
\node [#1,rectangle,fill=color_branch,draw=black!20!color_branch,line width=2pt,refText,minimum height=0.8cm] (rmain) {origin/main};
}
\newcommand{\branch}[2] {
\node [#1,rectangle,fill=color_branch,draw=black!20!color_branch,line width=2pt,refText,minimum height=0.8cm] (#2) {#2};
}

\newcommand{\HEAD}[1] {
\node [#1,rectangle,fill=color_HEAD,draw=black!20!color_HEAD,line width=2pt,refText,minimum height=0.8cm] (HEAD) {HEAD};
}
\newcommand{\rHEAD}[1] {
\node [#1,rectangle,fill=color_HEAD,draw=black!20!color_HEAD,line width=2pt,refText,minimum height=0.8cm] (rHEAD) {origin/HEAD};
}

\begin{tikzpicture} 

\commit{}{A}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (A) -- ++(-1,0);
\commit{right = 1cm of A}{B}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (B) -- (A);
\commit{right = 1cm of B}{C}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (C) -- (B);
\commit{right = 1cm of C}{D}{color_commit}{}{}
\draw [-,line width=3pt,draw=black!60] (D) -- (C);

\end{tikzpicture}
```
 . . .

- The system consists of **three trees**:

. . . 

. . . 

```{tikz}
%| label: Fig0a
%| engine: tikz
%| echo: false
%| fig-width: 6
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns}

\usetikzlibrary{arrows.meta}

\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}]
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]
\tikzstyle{hashText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 
\tikzstyle{commentText} = [font={\fontspec[Scale=1.0]{Inconsolata Nerd Font}}] 
\tikzstyle{refText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}
\definecolor{color_index}{rgb}{0.78,0.86,0.27}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}
\definecolor{color_main}{rgb}{0.36,0.27,0.87}
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}

% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

% Define dirtree
\makeatletter
\newcount\dirtree@lvl
\newcount\dirtree@plvl
\newcount\dirtree@clvl
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}
\makeatother

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}

\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

%\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
%\begin{tikzpicture}[dirtree,TREE,text=gray,color=gray]
%\node {} 
%child {node {file 2}}
%child { node {file 1}};
%\end{tikzpicture}
%};


%\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
%\begin{tikzpicture}[dirtree,TREE]
%\node {} 
%child {node {file 2}}
%child { node {file 1}};
%\end{tikzpicture}
%};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + %(1.3cm,0.2cm)$);
%\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 1}; 
\end{tikzpicture}
```

Git - overview
-----

Files can be in one of **four states**:

- **untracked**

```{tikz}
%| label: Fig0a
%| engine: tikz
%| echo: false
%| fig-width: 5
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"
```

Git - overview
-----

Files can be in one of **four states**:

- **untracked**
- **staged**

```{tikz}
%| label: Fig0b
%| engine: tikz
%| echo: false
%| fig-width: 5
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns}

\usetikzlibrary{arrows.meta}

\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}]
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]
\tikzstyle{hashText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 
\tikzstyle{commentText} = [font={\fontspec[Scale=1.0]{Inconsolata Nerd Font}}] 
\tikzstyle{refText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}
\definecolor{color_index}{rgb}{0.78,0.86,0.27}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}
\definecolor{color_main}{rgb}{0.36,0.27,0.87}
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}

% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

% Define dirtree
\makeatletter
\newcount\dirtree@lvl
\newcount\dirtree@plvl
\newcount\dirtree@clvl
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}
\makeatother

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}

\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE,text=gray,color=gray]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};


%\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
%\begin{tikzpicture}[dirtree,TREE]
%\node {} 
%child {node {file 2}}
%child { node {file 1}};
%\end{tikzpicture}
%};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + (1.3cm,0.2cm)$);
%\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 1}; 
\end{tikzpicture}
```

Git - overview 
-----

Files can be in one of **four states**:

- **untracked**
- **staged**
- **committed**

```{tikz}
%| label: Fig0c
%| engine: tikz
%| echo: false
%| fig-width: 7
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing,
shadings,shapes.geometric,patterns}

\usetikzlibrary{arrows.meta}

\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}]
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]
\tikzstyle{hashText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 
\tikzstyle{commentText} = [font={\fontspec[Scale=1.0]{Inconsolata Nerd Font}}] 
\tikzstyle{refText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}
\definecolor{color_index}{rgb}{0.78,0.86,0.27}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}
\definecolor{color_main}{rgb}{0.36,0.27,0.87}
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}

% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

% Define dirtree
\makeatletter
\newcount\dirtree@lvl
\newcount\dirtree@plvl
\newcount\dirtree@clvl
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}
\makeatother

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}

\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE,text=gray,color=gray]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};


\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 1}; 
\end{tikzpicture}
```



Git - overview
-----

Files can be in one of **four states**:

- **untracked**
- **staged**
- **committed**
- **modified**


```{tikz}
%| label: Fig0d
%| engine: tikz
%| echo: false
%| fig-width: 7
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns}

\usetikzlibrary{arrows.meta}

\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}]
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]
\tikzstyle{hashText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 
\tikzstyle{commentText} = [font={\fontspec[Scale=1.0]{Inconsolata Nerd Font}}] 
\tikzstyle{refText} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}] 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}
\definecolor{color_index}{rgb}{0.78,0.86,0.27}
\definecolor{color_local}{rgb}{0.9,0.9,0.2}
\definecolor{color_remote}{rgb}{1,0.55,0.15}
\definecolor{color_main}{rgb}{0.36,0.27,0.87}
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}

% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

% Define dirtree
\makeatletter
\newcount\dirtree@lvl
\newcount\dirtree@plvl
\newcount\dirtree@clvl
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}
\makeatother

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}

\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child [text=color_workspace]{node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE,text=gray,color=gray]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};


\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 1}; 
\end{tikzpicture}
```



## Git - overview 

::: columns
::: {.column width="40%"}

```{tikz}
%| label: fig4
%| engine: tikz
%| echo: false
%| fig-width: 7
%| out-width: 100%
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns} %
\usetikzlibrary{arrows.meta}%
\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}] %
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]%
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]% 
\tikzstyle{fileText} = [font={\fontspec[Scale=1]{Inconsolata Nerd Font}}]% 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}%
\definecolor{color_index}{rgb}{0.78,0.86,0.27}%
\definecolor{color_local}{rgb}{0.9,0.9,0.2}%
\definecolor{color_remote}{rgb}{1,0.55,0.15}%
\definecolor{color_main}{rgb}{0.36,0.27,0.87}%
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}%
 
% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}%

% Define dirtree
\makeatletter%
\newcount\dirtree@lvl%
\newcount\dirtree@plvl%
\newcount\dirtree@clvl%
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}%

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}%
\makeatother%

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}%

\begin{tikzpicture}

\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE,text=gray,color=gray]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};


\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 1}; 
\end{tikzpicture}
```
:::

::: {.column width="40%"}
```{tikz}
%| label: gitcommits1
%| engine: tikz
%| echo: false
%| fig-width: 0.5
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-commit.tex"

\begin{tikzpicture} 
\commit{}{A}{color_commit}{}{}
\draw [-,line width=3pt,draw=black!60] (A) -- ++(-1,0);
\end{tikzpicture}

```

:::

:::

::: columns
::: {.column width="40%"}

```{tikz}
%| label: fig5
%| engine: tikz
%| echo: false
%| fig-width: 7
%| out-width: 100%
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns} %
\usetikzlibrary{arrows.meta}%
\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}] %
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]%
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]% 
\tikzstyle{fileText} = [font={\fontspec[Scale=1]{Inconsolata Nerd Font}}]% 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}%
\definecolor{color_index}{rgb}{0.78,0.86,0.27}%
\definecolor{color_local}{rgb}{0.9,0.9,0.2}%
\definecolor{color_remote}{rgb}{1,0.55,0.15}%
\definecolor{color_main}{rgb}{0.36,0.27,0.87}%
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}%

% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

% Define dirtree
\makeatletter
\newcount\dirtree@lvl
\newcount\dirtree@plvl
\newcount\dirtree@clvl
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}
\makeatother

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}
\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child { node {file 3}}
child [text=color_workspace]{node {file 2}}
child [text=color_workspace]{ node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE,color=gray,text=gray]
\node {} 
child { node {file 3}}
child {node {file 2}}
child {node {file 1}};
\end{tikzpicture}
};


\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child { node {file 3}}
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 2}; 

\node [anchor=north west] at ($(L0) +(-1.2cm,-1cm)$)  (L1) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L1.north) + (1.3cm,-0.4cm)$)  -- ($(L1.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L1) +(1.5,-0.1)$) {committed snapshot 1};  
\end{tikzpicture}
```
:::

::: {.column width="40%"}

```{tikz}
%| label: gitcommits2
%| engine: tikz
%| echo: false
%| fig-width: 1
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-commit.tex"

\begin{tikzpicture} 

\commit{}{A}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (A) -- ++(-1,0);
\commit{right = 1cm of A}{B}{color_commit}{}{}
\draw [-,line width=3pt,draw=black!60] (B) -- (A);
\end{tikzpicture}
```

:::

:::


::: columns
::: {.column width="40%"}
```{tikz}
%| label: fig6
%| engine: tikz
%| echo: false
%| fig-width: 7
%| out-width: 100%
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-standalone.tex"

\usetikzlibrary{shapes,arrows,shadows,positioning,mindmap,backgrounds,decorations, calc,fit, decorations.pathreplacing,decorations.pathmorphing, shadings,shapes.geometric,patterns} %
\usetikzlibrary{arrows.meta}%
\tikzstyle{TARGET} = [font={\fontspec[Scale=2]{Ubuntu}}] %
\tikzstyle{CODE} = [font={\fontspec[Scale=2]{Inconsolata Nerd Font}}]%
\tikzstyle{TREE} = [font={\fontspec[Scale=1.5]{Inconsolata Nerd Font}}]% 
\tikzstyle{fileText} = [font={\fontspec[Scale=1]{Inconsolata Nerd Font}}]% 

\definecolor{color_workspace}{rgb}{0.12,0.6,0.51}%
\definecolor{color_index}{rgb}{0.78,0.86,0.27}%
\definecolor{color_local}{rgb}{0.9,0.9,0.2}%
\definecolor{color_remote}{rgb}{1,0.55,0.15}%
\definecolor{color_main}{rgb}{0.36,0.27,0.87}%
\definecolor{color_head}{HTML}{6495ED} %\definecolor{color_head}{rgb}{0.26,0.65,0.91}%

% A template for making the storage symbol
\newcommand{\state}[3]{
\draw (#1) node [draw=none,fill=#2,shape=circle,minimum width=2cm] (#3) {
\begin{tikzpicture}
\node [draw=white, fill=white,shape=cylinder,shape aspect=1.3 ,shape border rotate=90,minimum height=1.6cm,minimum width=1.5cm] at (0,0) (Cylinder) {};				\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.1cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.5cm)$) arc (-180:0:0.8cm and 0.2cm); 
\draw[draw=#2,very thick,line width=0.1cm,anchor=north west] ($(Cylinder.north west) +(-0.05cm,-0.9cm)$) arc (-180:0:0.8cm and 0.2cm); 
\end{tikzpicture}
};
}

% Define dirtree
\makeatletter
\newcount\dirtree@lvl
\newcount\dirtree@plvl
\newcount\dirtree@clvl
\def\dirtree@growth{%
\ifnum\tikznumberofcurrentchild=1\relax
\global\advance\dirtree@plvl by 1
\expandafter\xdef\csname dirtree@p@\the\dirtree@plvl\endcsname{\the\dirtree@lvl}
\fi
\global\advance\dirtree@lvl by 1\relax
\dirtree@clvl=\dirtree@lvl
\advance\dirtree@clvl by -\csname dirtree@p@\the\dirtree@plvl\endcsname
\pgf@xa=0.25cm\relax
\pgf@ya=-0.5cm\relax
\pgf@ya=\dirtree@clvl\pgf@ya
\pgftransformshift{\pgfqpoint{\the\pgf@xa}{\the\pgf@ya}}%
\ifnum\tikznumberofcurrentchild=\tikznumberofchildren
\global\advance\dirtree@plvl by -1
\fi
}

\tikzset{
dirtree/.style={
growth function=\dirtree@growth,
every node/.style={anchor=north},
every child node/.style={anchor=west},
edge from parent path={(\tikzparentnode\tikzparentanchor) |- (\tikzchildnode\tikzchildanchor)}
}
}
\makeatother

\newcommand{\file}[3] {
\coordinate (#3) at (#1);
\draw [anchor=top left](#1) rectangle ++(1.5,-2);
\draw [fill=color_workspace]($(#1) +(1.5,0)$) -- ++(0,-0.5) --++(-0.5,0.5) -- cycle; 
\node [anchor=north west,fileText] at ($(#1) +(0,-0.5)$) {#2};
}

\begin{tikzpicture}

\state{0,0}{color_workspace}{W}
\node[TARGET,fill=white] at ($(W.north) +(0,0.5cm)$) {Workspace};
\state{6,0}{color_index}{I}
\node[TARGET,fill=white] at ($(I.north) +(0,0.5cm)$) {Staging Area};
\state{12,0}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_index] ($(W.east) + (0.1cm,0)$) -- ($(I.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {add};

\draw[{Round Cap[length=0.5em]}-Triangle Cap,very thick, line width=1cm, draw=color_local] ($(I.east) + (0.1cm,0)$) -- ($(L.west) + (-0.1cm,0)$) node[anchor=center,pos=0.5, text=black,align=center,CODE] {commit};

\node [anchor=north west] at ($(W) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child [text=color_workspace]{ node {file 3}}
child [text=color_workspace]{node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
%\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(W0.north) + (-1cm,-1cm)$)  -- ($(W0.south) + (-1cm,0.2cm)$);

\node [anchor=north west] at ($(I) +(-1cm,-1cm)$)  (W0) {
\begin{tikzpicture}[dirtree,TREE,color=gray,text=gray]
\node {} 
child [text=color_index]{ node {file 3}}
child [text=color_index]{ node {file 2}}
child { node {file 1}};

\end{tikzpicture}
};

\node [anchor=north west] at ($(L) +(-1cm,-1cm)$)  (L0) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child { node {file 3}}
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L0.north) + (1.3cm,-0.4cm)$)  -- ($(L0.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L0) +(1.5,-0.1)$) {committed snapshot 3}; 

\node [anchor=north west] at ($(L0) +(-1.2cm,-1cm)$)  (L1) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child { node {file 3}}
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L1.north) + (1.3cm,-0.4cm)$)  -- ($(L1.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L1) +(1.5,-0.1)$) {committed snapshot 2}; 

\node [anchor=north west] at ($(L1) +(-1.2cm,-1cm)$)  (L2) {
\begin{tikzpicture}[dirtree,TREE]
\node {} 
child {node {file 2}}
child { node {file 1}};
\end{tikzpicture}
};
\draw[decorate,decoration={brace,amplitude=5pt},very thick] ($(L2.north) + (1.3cm,-0.4cm)$)  -- ($(L2.south) + (1.3cm,0.2cm)$);
\node [TREE,anchor=west] at ($(L2) +(1.5,-0.1)$) {committed snapshot 1}; 

\end{tikzpicture}
```
:::

::: {.column width="40%"}
```{tikz}
%| label: gitcommits3
%| engine: tikz
%| echo: false
%| fig-width: 1.5
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-commit.tex"

\begin{tikzpicture} 
\commit{}{A}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (A) -- ++(-1,0);
\commit{right = 1cm of A}{B}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (B) -- (A);
\commit{right = 1cm of B}{C}{color_commit}{}{}
\draw [-,line width=3pt,draw=black!60] (C) -- (B);
\end{tikzpicture}
```

:::

:::


Git - overview
----

```{tikz}
%| label: OverviewFig1
%| engine: tikz
%| echo: false
%| fig-width: 7
%| out-width: 80%
%| cache: true
%| class: tikz
%| engine-opts:
%|   template: "../resources/tikz-commit.tex"

\begin{tikzpicture}

\commit{}{A}{color_inactive}{}{}
\commit{right = 1cm of A}{B}{color_inactive}{}{}
\commit{right = 1cm of B}{C}{color_commit}{}{}
\draw [-,line width=3pt,draw=black!60] (A) -- ++(-1,0);
\draw [-,line width=3pt,draw=black!60] (B) -- (A);
\draw [-,line width=3pt,draw=black!60] (C) -- (B);
\commit{above = 0.5cm of B}{D}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (A.east) to[out=0,in=180] (D);
\main{right = 0.5cm of C}\draw[->,line width=3pt,draw=black!60] (main) -- (C);
\HEAD{right = 0.5cm of main}\draw[->,line width=3pt,draw=black!60] (HEAD) -- (main);
\branch{right = 0.5cm of D}{Feature}\draw[->,line width=3pt,draw=black!60] (Feature) -- (D);

\rcommit{right = 3cm of HEAD}{rA}{color_inactive}{}{}
\rcommit{right = 1cm of rA}{rB}{color_inactive}{}{}
\rcommit{right = 1cm of rB}{rC}{color_inactive}{}{}
\rcommit{right = 1cm of rC}{rC2}{color_commit}{}{}
\draw [-,line width=3pt,draw=black!60] (rA) -- ++(-1,0);
\draw [-,line width=3pt,draw=black!60] (rB) -- (rA);
\draw [-,line width=3pt,draw=black!60] (rC) -- (rB);
\draw [-,line width=3pt,draw=black!60] (rC2) -- (rC);

\rcommit{above = 0.5cm of rB}{rD}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (rA.east) to[out=0,in=180] (rD);
\rmain{right = 0.5cm of rC2}\draw[->,line width=3pt,draw=black!60] (rmain) -- (rC2);
\branch{right = 0.5cm of rD}{origin/Feature}\draw[->,line width=3pt,draw=black!60] (origin/Feature) -- (rD);
\rcommit{below = 0.5cm of rB}{rE}{color_inactive}{}{}
\draw [-,line width=3pt,draw=black!60] (rA.east) to[out=0,in=180] (rE);
\branch{right = 0.5cm of rE}{origin/dev}\draw[->,line width=3pt,draw=black!60] (origin/dev) -- (rE);
\rHEAD{right = 0.5cm of rmain}\draw[->,line width=3pt,draw=black!60] (rHEAD) -- (rmain);

\state{$(A) +(0,3cm)$}{color_local}{L}
\node[TARGET,fill=white] at ($(L.north) +(0,0.5cm)$) {Local Repository};

\state{$(rA) +(0,3cm)$}{color_remote}{R}
\node[TARGET,fill=white] at ($(R.north) +(0,0.5cm)$) {Remote Repository};

\end{tikzpicture}

```

 
# Git in depth

## Git - configuration 

This is a **once off action** (_per machine_)

>- define who you are 

. . .
```{r, engine='bash',results="markup", prompt=FALSE,eval=FALSE}
git config --global user.name "Your name"
git config --global user.email "your_email@whatever.com"
```
. . .

- Specify that the initial **branch** should be called _main_ rather
         than _master_
```{r, engine='bash',results="markup", prompt=FALSE,eval=FALSE}
git config --global init.defaultBranch main
```

- Check these settings
```{r, engine='bash',results="markup", prompt=FALSE,eval=TRUE}
git config --global --list
```
 

## Git - configuration 

Or within R (via the [usethis](https://usethis.r-lib.org/articles/articles/usethis-setup.html) _package_)

```{r use_git_config, results='markdown', eval=FALSE}
usethis::use_git_config(user.name='Your name',
               user.email='your_email@whatever.com',
               scope='user')
usethis::git_sitrep()
```
OR via the [gert](https://jeroen.cran.dev/gert) _package_
```{r gert_config, results='markdown', eval=FALSE}
gert::git_config_global()
```


## Git - new repository
  
```{r, engine='R',results="markup", prompt=FALSE,eval=TRUE, echo=FALSE}
unlink('~/tmp/Test_repo', recursive=TRUE, force=TRUE)
```

```{r, engine='bash',results="hide", prompt=FALSE,eval=TRUE}
mkdir ~/tmp/Test_repo
cd ~/tmp/Test_repo
```

```{r, engine='bash',results="hide", prompt=FALSE,eval=TRUE, echo=-1}
cd ~/tmp/Test_repo
git init
```

### RStudio

```{bash, echo=FALSE, eval=TRUE, include=FALSE}
convert resources/RStudio_NewProject2a.png -resize 250x resources/RStudio_NewProject2a_small.png 
convert resources/RStudio_NewProject3a.png -resize 250x resources/RStudio_NewProject3a_small.png
```

![](resources/RStudio_NewProject1.png)
![](resources/RStudio_NewProject2a_small.png)
![](resources/RStudio_NewProject3a_small.png)

### R
```{r create_package, results='markdown', eval=FALSE}
library(usethis)
create_project(path='~/path/project_name', rstudio=TRUE)
use_git()
```



Git - adding content
----------------------

<br>

Create a file (text, code etc) <br><br>

- those using R, call it **analysis.R**

```{r, engine='R',results="markup", prompt=FALSE,eval=FALSE}
x=seq(1, 10, len = 1)
y=40 * 2 + rnorm(10, 0, 5)
plot(x, y)
```

<br><br>
	
Otherwise, create any kind of file (**in the folder we just created**)

```{r, engine='bash',results="markup", prompt=FALSE,eval=TRUE, echo=FALSE}
cd ~/tmp/Test_repo
echo 'x=seq(1, 10, len = 1)' > analysis.R
echo 'y=40 * 2 + rnorm(10, 0, 5)' >> analysis.R
echo 'plot(x, y)' >> analysis.R
```
 
Git - adding content
----------------------

Stage the changes (**add**)

```{r, engine='bash',results="markup", prompt=FALSE,eval=FALSE,echo=TRUE}
git add <file(s)>
```
For example:
```{r, engine='bash',results="markup", prompt=FALSE,eval=TRUE,echo=-1}
cd ~/tmp/Test_repo
git add analysis.R
```
### RStudio

```{bash, echo=FALSE, eval=TRUE, include=FALSE}
convert resources/RStudio_AddFile.png  -resize 400x resources/RStudio_AddFile_small.png
convert resources/RStudio_GitStatus.png -resize 300x resources/RStudio_GitStatus_small.png
convert resources/RStudio_GitAdd.png -resize 300x resources/RStudio_GitAdd_small.png

convert resources/RStudio_GitStatus.png resources/RStudio_GitAdd.png -append resources/RStudio_GitAdd_combined.png
```

![](resources/RStudio_AddFile_small.png){width=40%}
![](resources/RStudio_GitAdd_combined.png){width=30%}

```{r gert_add, results='markdown', eval=FALSE}
gert::git_add('analysis.R')
```

Git - adding content
----------------------

```{r, engine='bash',results="hide", prompt=FALSE,eval=TRUE, echo=FALSE}
../resources/git-draw --image-only --sha1-length 5 --hide-legend --hide-reflogs --git-dir ~/tmp/Test_repo/.git --image-filename resources/Test_repo0.png
```

```{tikz Fig0b, engine='tikz',cache=TRUE,fig.show='hide',eval=TRUE, echo=FALSE,engine.opts = list(template = "../resources/tikz.tex"), fig.width=6}
```
![](resources/Test_repo0.png)


Git - .gitignore
------------------

### RStudio

```{bash, echo=FALSE, eval=TRUE, include=FALSE}
convert resources/RStudio_gitignore.png -resize 350x resources/RStudio_gitignore_small.png
convert resources/Rstudio_gitignore2.png -resize 350x resources/RStudio_gitignore2_small.png
```
![](resources/RStudio_gitignore_small.png)
![](resources/RStudio_gitignore2_small.png)

Examples

- `.RData` all files ending in .RData 
- `.pdf` all files ending in .pdf
- `data/` the entire folder called data



Git - committing
----------------------

```{r, engine='bash',results="markup", prompt=FALSE,eval=TRUE, echo=-1}
cd ~/tmp/Test_repo
git commit -m 'Initial commit'
```

```{r, engine='bash',results="markup", prompt=FALSE,eval=TRUE}
cd ~/tmp/Test_repo
git status
```
```{r, engine='bash', prompt=FALSE,eval=TRUE}
../resources/git-tikz --git-dir ~/tmp/Test_repo/.git --filename 10_pres_git_Test_repo1.tex
ls -la 
#mv 10_pres_git_Test_repo1.pdf resources/10_pres_git_Test_repo1.pdf
```

